<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Movix</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../static/css/dashboard.css">
</head>
<body>

<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Dashboard da Frota</h2>
    <a href="{{ url_for('cadastrar_frota') }}" class="btn btn-success">+ Cadastrar Frota</a>
  </div>

  <!-- ====== Cards de Contagem ====== -->
  <div class="row mb-4">
    {% if contagem %}
      {% for item in contagem %}
      <div class="col-md-2 mb-3">
        <div class="card text-center bg-dark text-light">
          <div class="card-body">
            <h5 class="card-title text-capitalize">{{ item.tipo }}</h5>
            <p class="card-text display-6">{{ item.total }}</p>
          </div>
        </div>
      </div>
      {% endfor %}
    {% else %}
      <p class="text-center">Nenhum ve√≠culo cadastrado ainda.</p>
    {% endif %}
  </div>

<!-- ====== Cards de Frotas ====== -->
<div class="row mb-4">
  {% if frotas %}
    {% for frota in frotas %}
    <div class="col-md-3 mb-3">
      <div class="card bg-secondary text-light text-center position-relative">
        <form action="{{ url_for('excluir_frota', frota_id=frota.id) }}" method="POST"
              onsubmit="return confirm('Tem certeza que deseja excluir a frota {{ frota.nome }}?')" 
              class="position-absolute top-0 end-0 m-2">
          <button type="submit" class="btn btn-sm btn-danger" title="Excluir Frota">
            üóëÔ∏è
          </button>
        </form>
        <div class="card-body" onclick="window.location.href='{{ url_for('frota', frota_id=frota.id) }}'">
          <h5 class="card-title">{{ frota.nome }}</h5>
          <p class="card-text text-capitalize">{{ frota.tipo }}</p>
        </div>
      </div>
    </div>
    {% endfor %}
  {% else %}
    <p class="text-center">Nenhuma frota cadastrada ainda.</p>
  {% endif %}
</div>

  <!-- ====== Documentos Pr√≥ximos ao Vencimento ====== -->
  <div class="card bg-secondary p-3">
    <h4 class="mb-3">Documentos Pr√≥ximos do Vencimento</h4>
    {% if documentos %}
    <table class="table table-dark table-hover align-middle">
      <thead>
        <tr>
          <th>Ve√≠culo</th>
          <th>Tipo</th>
          <th>Documento</th>
          <th>Data Venc.</th>
          <th>Dias Restantes</th>
        </tr>
      </thead>
      <tbody>
        {% for doc in documentos %}
        <tr class="{% if doc.dias_restantes <= 5 %}table-danger{% elif doc.dias_restantes <= 15 %}table-warning{% endif %}">
          <td>{{ doc.nome }}</td>
          <td>{{ doc.tipo }}</td>
          <td>{{ doc.tipo_documento }}</td>
          <td>{{ doc.data_vencimento.strftime('%d/%m/%Y') }}</td>
          <td>
            {% if doc.dias_restantes < 0 %}
              Vencido ({{ doc.dias_restantes }})
            {% else %}
              {{ doc.dias_restantes }}
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
      <p class="text-center">Nenhum documento cadastrado ainda.</p>
    {% endif %}
  </div>
</div>

</body>
</html>
